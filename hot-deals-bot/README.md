# üî• StolenBikeBot - Hot Deals Telegram Bot

–¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç –¥–ª—è –ø—Ä–∏—ë–º–∞ "–≥–æ—Ä—è—á–∏—Ö" —Å—Å—ã–ª–æ–∫ –Ω–∞ –≤–µ–ª–æ—Å–∏–ø–µ–¥—ã –æ—Ç –∞–∫–∫—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Å—ã–ª–∫–∏ —á–µ—Ä–µ–∑ Hunter pipeline –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–∞—Ç–∞–ª–æ–≥ BikeWerk.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ whitelist (—Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å —Å—Å—ã–ª–∫–∏)
- üîó –£–º–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç + —Å—Å—ã–ª–∫—É)
- üö´ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (–≤ `stolen_bikes` –∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `bikes`)
- ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ HotDealHunter —Å AI –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π (Gemini)
- üí∞ –†–∞—Å—á—ë—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã –ø–æ —Ñ–æ—Ä–º—É–ª–µ CashflowLogic
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –±–∞–π–∫–∞–º–∏

## üõ† –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- Kleinanzeigen
- eBay / eBay Kleinanzeigen
- Mobile.de
- Buycycle
- AutoScout24
- –î—Ä—É–≥–∏–µ (–±–∞–∑–æ–≤—ã–π scraping)

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
cd hot-deals-bot
npm install
```

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# Telegram Bot Token
TELEGRAM_BOT_TOKEN=YOUR_HOT_DEALS_BOT_TOKEN

# Supabase Credentials (–ø–æ–ª—É—á–∏—Ç–µ –∏–∑ backend/.env –∏–ª–∏ Supabase Dashboard)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (Chat IDs —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
# –ü–æ—Å–ª–µ /start –±–æ—Ç –≤—ã–¥–∞—Å—Ç –≤–∞—à Chat ID
AUTHORIZED_USERS=123456789,987654321

# –ö—É—Ä—Å EUR/RUB
EUR_RUB_RATE=96
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –≤ Supabase

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é `migrations/001_stolen_bikes.sql` –≤ Supabase SQL Editor:

```sql
-- –û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard ‚Üí SQL Editor
-- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ migrations/001_stolen_bikes.sql
-- –í—ã–ø–æ–ª–Ω–∏—Ç–µ
```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
npm start
```

–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å auto-reload:

```bash
npm run dev
```

## üéÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –±–æ—Ç—É –≤ Telegram
2. –ë–æ—Ç –≤—ã–¥–∞—Å—Ç –≤–∞—à `Chat ID`
3. –î–æ–±–∞–≤—å—Ç–µ —ç—Ç–æ—Ç ID –≤ `.env` ‚Üí `AUTHORIZED_USERS`
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏

–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É (–º–æ–∂–Ω–æ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º):

```
–°–º–æ—Ç—Ä–∏ –∫–∞–∫–æ–π –∫—Ä—É—Ç–æ–π –±–∞–π–∫! https://www.kleinanzeigen.de/s-anzeige/...
```

–ë–æ—Ç:
- –ò–∑–≤–ª–µ—á—ë—Ç URL
- –ü—Ä–æ–≤–µ—Ä–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã
- –°–æ—Ö—Ä–∞–Ω–∏—Ç –≤ –ë–î
- –ó–∞–ø—É—Å—Ç–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —á–µ—Ä–µ–∑ Hunter
- –£–≤–µ–¥–æ–º–∏—Ç –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

### –ö–æ–º–∞–Ω–¥—ã

- `/start` - –ò–Ω—Ñ–æ –∏ –≤–∞—à Chat ID
- `/hot [page]` - –°–ø–∏—Å–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –±–∞–π–∫–æ–≤ (–ø–æ 5 —à—Ç)
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–≤—Å–µ–≥–æ, –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º, –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º)
- `/delete [id]` - –£–¥–∞–ª–∏—Ç—å –±–∞–π–∫ –ø–æ UUID

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
hot-deals-bot/
‚îú‚îÄ‚îÄ index.js                    # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ StolenBikeService.js   # –†–∞–±–æ—Ç–∞ —Å Supabase (stolen_bikes)
‚îÇ   ‚îî‚îÄ‚îÄ HunterAdapter.js       # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Hunter pipeline
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ UrlExtractor.js        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ URL –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ PriceFormatter.js      # –†–∞—Å—á—ë—Ç —Ü–µ–Ω (CashflowLogic)
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ 001_stolen_bikes.sql   # SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è Supabase
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ .env
‚îî‚îÄ‚îÄ README.md
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏** ‚Üí UrlExtractor –∏–∑–≤–ª–µ–∫–∞–µ—Ç URL
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤** ‚Üí StolenBikeService –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤ –ë–î
3. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** ‚Üí –ó–∞–ø–∏—Å—å –≤ `stolen_bikes` (status: pending)
4. **–û–±—Ä–∞–±–æ—Ç–∫–∞** ‚Üí HunterAdapter:
   - Scraping —á–µ—Ä–µ–∑ Puppeteer
   - Preprocessing (Kleinanzeigen/Buycycle/Fallback)
   - AI –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Gemini (UnifiedNormalizer)
   - Quality Gate (score >= 40)
   - –ü–æ–º–µ—Ç–∫–∞ –∫–∞–∫ Hot Deal
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `bikes` —á–µ—Ä–µ–∑ DatabaseService
5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ** ‚Üí –°—Ç–∞—Ç—É—Å –≤ `stolen_bikes` ‚Üí completed
6. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ** ‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ Telegram

## üí∞ –†–∞—Å—á—ë—Ç —Ü–µ–Ω

–§–∏–Ω–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ –∏–∑ `CashflowLogic.md`:

```javascript
// –°–µ—Ä–≤–∏—Å
if (price < ‚Ç¨1500)  ‚Üí ‚Ç¨250
if (price < ‚Ç¨3500)  ‚Üí ‚Ç¨400
if (price < ‚Ç¨6000)  ‚Üí ‚Ç¨600
else                ‚Üí 10% –æ—Ç —Ü–µ–Ω—ã

// –°—Ç—Ä–∞—Ö–æ–≤—ã–µ —Å–±–æ—Ä—ã
insurance = price √ó 2.5% + ‚Ç¨40

// –ò—Ç–æ–≥–æ
subtotal = bike + delivery + service + insurance
total = subtotal √ó 1.07  // +7% –∫–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—ë–∂–∫–∏
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Whitelist –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (—Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ Chat IDs)
- ‚úÖ –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ `.env` (–¥–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`!)
- ‚úÖ Service Role Key –¥–ª—è Supabase (–Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ!)

## üêõ Troubleshooting

### "Supabase credentials missing"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env`:
- `SUPABASE_URL` –∏ `SUPABASE_SERVICE_ROLE_KEY` –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤
- –§–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∫–æ—Ä–Ω–µ `hot-deals-bot/`

### "Hunter integration not available"

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- –ü—É—Ç—å `BACKEND_PATH` –≤ `.env` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `../backend`
- –§–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç:
  - `backend/src/services/UnifiedNormalizer.js`
  - `backend/src/services/database-service-v2.js`

### "Failed to scrape bike data"

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å URL (–Ω–µ —É–¥–∞–ª—ë–Ω –ª–∏)
- Puppeteer –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
  ```bash
  # Windows
  npm install --save puppeteer

  # Linux
  sudo apt-get install -y chromium-browser
  ```

## üìù TODO / –£–ª—É—á—à–µ–Ω–∏—è

- [ ] –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ `bikes` –¥–ª—è /hot (—Å–µ–π—á–∞—Å –∑–∞–≥–ª—É—à–∫–∞)
- [ ] Webhook mode –≤–º–µ—Å—Ç–æ polling –¥–ª—è production
- [ ] –ö–Ω–æ–ø–∫–∏ (inline keyboard) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–π–∫–∞–º–∏
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å—Ç–∞—Ç—É—Å–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è whitelist

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

**BikeWerk** ¬© 2026
