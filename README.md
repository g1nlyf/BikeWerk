# Документация проекта EUBike

## 1. Описание и концепция проекта
EUBike — это комплексная платформа для агрегации, парсинга и продажи велосипедов из Германии. Система автоматизирует процесс поиска, категоризации и доставки велосипедов клиентам.

**Ключевые особенности:**
- **Агрегатор и Парсер:** Автоматически собирает объявления о продаже велосипедов с крупных европейских площадок (Buycycle, Bikeflip и др.).
- **Умный Каталог:** Расширенная фильтрация, сортировка и персонализированные рекомендации.
- **Логистика доставки:** Встроенный калькулятор и отслеживание доставки велосипедов из Германии.
- **Мультиплатформенность:** Веб-интерфейс (React) и Telegram-боты как для клиентов, так и для администрирования.

## 2. Обзор архитектуры
Проект следует современной клиент-серверной архитектуре:

- **Frontend:** Разработан на **React (Vite)**, использует **Tailwind CSS** для стилизации и **Shadcn UI** для компонентов. Взаимодействует с бэкендом через REST API.
- **Backend:** **Node.js** с **Express**, предоставляет API-эндпоинты для фронтенда и ботов.
- **База данных:** **SQLite** (`backend/database/eubike.db`) хранит все данные, включая пользователей, велосипеды, заказы и логи.
- **Telegram-боты:**
  - `telegram-bot`: Выполняет административные задачи и отправляет уведомления.
  - `client-telegram-bot`: Предоставляет удобный мобильный интерфейс для клиентов для просмотра каталога и отслеживания заказов.

## 3. Описание страниц

| URL страницы | Описание |
|----------|-------------|
| `/` (Лендинг) | Главная точка входа. Содержит Hero-секцию, блок "Как это работает", преимущества и мини-каталог. |
| `/catalog` | Полный каталог велосипедов с боковыми фильтрами (Тип, Бренд, Цена и т.д.), сортировкой и бесконечной прокруткой/пагинацией. |
| `/product/:id` | Детальный просмотр конкретного велосипеда. Включает галерею высокого разрешения, полные характеристики, информацию о доставке и кнопку "В корзину". |
| `/cart` | Корзина покупок. Пользователи могут просмотреть товары и выбрать между "Оформлением через менеджера" или "Автоматическим оформлением". |
| `/calculator` | Калькулятор стоимости доставки, позволяющий оценить расходы на перевозку в зависимости от типа велосипеда и местоположения. |
| `/login` | Страница аутентификации пользователя (вкладки Вход и Регистрация). |
| `/favorites` | Персональный список избранного для авторизованных пользователей. |
| `/order-tracking` | Страница для отслеживания статуса доставки по номеру заказа. |
| `/about` | Информация о компании, гарантиях, отзывы и контактные данные. |
| `/admin` | Админ-панель. Предоставляет аналитику, системные логи и управление пользователями. |
| `/catalog/admin` | Внутренний инструмент для управления объявлениями велосипедов (редактирование, скрытие, продвижение). |
| `/guest-order` | Упрощенный мастер оформления заказа для пользователей без аккаунта. |

## 4. Использование файлов и дерево навигации (Путь пользователя)

Это дерево иллюстрирует, как пользователь обычно перемещается по файлам/страницам приложения:

```mermaid
graph TD
    A[Лендинг (/)] -->|Клик 'Каталог'| B[Страница Каталога (/catalog)]
    A -->|Клик 'Калькулятор'| C[Страница Калькулятора (/calculator)]
    A -->|Клик 'Войти'| D[Страница Входа (/login)]
    
    B -->|Выбор велосипеда| E[Детальная страница товара (/product/:id)]
    B -->|Фильтр/Сортировка| B
    
    E -->|В корзину| F[Корзина (/cart)]
    E -->|В избранное| G[Избранное (/favorites)]
    
    F -->|Оформление| H[Мастер заказа (/guest-order или /checkout)]
    H -->|Успех| I[Страница успеха заказа]
    
    D -->|Успешный вход| B
    
    subgraph Админка
    J[Админ-панель (/admin)] --> K[Управление каталогом (/catalog/admin)]
    end
    
    subgraph Утилиты
    L[Отслеживание заказа (/order-tracking)]
    M[О нас (/about)]
    end
```

**Ключевые компоненты навигации:**
- **AppRouter.tsx** (`frontend/src/routes/AppRouter.tsx`): Центральный хаб, определяющий, какой компонент загружается для каждого URL.
- **Header/Navbar**: Присутствует на всех страницах, содержит ссылки на Каталог, Калькулятор, Отслеживание и Профиль.
- **Footer**: Содержит ссылки на "О нас", Контакты и Политику.

## 5. Структура директорий для деплоя
- `frontend/`: Исходный код React. Требует сборки (`npm run build`) -> результат в `dist/`.
- `backend/`: API сервер. Запускается через `node server.js`.
- `telegram-bot/` & `client-telegram-bot/`: Сервисы ботов, работающие независимо.
- `backend/database/`: Содержит файл базы данных SQLite.

Для подробных шагов по развертыванию, пожалуйста, обратитесь к файлу `DeploymentPlan.md`.

## 6. Безопасная работа с GitHub и Cloud Codex
- Полный регламент: `docs/cloud-codex-github-playbook.md`
- Подготовка репозитория (хуки + скан секретов):
  - `powershell -ExecutionPolicy Bypass -File .\scripts\github\prepare-cloud-sync.ps1 -RunFullTrackedScan`
- Надежный push с повторами:
  - `powershell -ExecutionPolicy Bypass -File .\scripts\github\push-with-retry.ps1 -Remote origin -Branch <branch>`
- В репозиторий не коммитятся реальные ключи: используются только `.env.example`, реальные значения хранятся локально и в GitHub Secrets.
