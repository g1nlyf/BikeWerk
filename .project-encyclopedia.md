
### 02.02.2026 Sprint 14: Strict Catalog Classification & Wheel Size Consistency
- **Problem:** Catalog filters (MTB/Road/Gravel sub-categories) were broken due to NULL `sub_category`. `discipline` was missing. `wheel_size` was inconsistent (sometimes NULL in main column despite being in JSON).
- **Solution - AI Classification:**
  - Updated `gemini-bike-normalizer-v2.5-compact.md` with **STRICT CLASSIFICATION RULES**.
  - Defined explicit mapping for `sub_category` (e.g., "enduro", "race", "adventure") and `discipline`.
  - Enforced `wheel_size` extraction.
- **Solution - Database & Mapper:**
  - Updated `UnifiedBikeMapper.js` to map `sub_category` and `discipline` from AI output.
  - Updated `DatabaseService.js` to:
    1.  Include `sub_category`, `wheel_size` in the `INSERT` statement (previously missing).
    2.  Implement fallback logic: `wheel_size = mapped || specs.wheel_size || specs_json.wheel_size`.
- **Solution - Frontend & API:**
  - Updated `backend/server.js` to support `sub_category` filtering (single value & array).
  - Updated `frontend/src/pages/CatalogPage.tsx` to send `sub_category` parameter instead of `discipline`.
  - Implemented mapping in Frontend to align UI keys (e.g. "climbing" -> "race") with DB values.
- **Verification:**
  - Created `scripts/verify_classification_fix.js` to confirm DB insertion.
  - Validated API query logic via `backend/scripts/verify_api_filters.js` (Simulated Frontend Request -> SQL Generation -> DB Result).
  - Confirmed `sub_category` ("enduro") and `wheel_size` ("29"") are correctly persisted and queryable.
