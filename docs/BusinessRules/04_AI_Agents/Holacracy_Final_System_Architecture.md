# Holacracy Final System Architecture (BikeWerk)

Статус: Draft v1  
Дата: 2026-02-15  
Основание: текущая код-база (`frontend`, `backend`, `telegram-bot`, `manager-bot`, `client-telegram-bot`) + бизнес-правила `ProjectBibleLatest.md` и `CashflowLogic.md`.

## 1. Зачем компании сеть AI-руководителей

Цель не в том, чтобы сделать еще одного ассистента, а в том, чтобы построить управляемую операционную систему:

- люди делают работу по клиенту и продавцу;
- ИИ-руководители снимают рутину контроля, постановки задач, SLA и кризис-эскалаций;
- AI-CEO собирает решения кругов в единый P&L и риск-контур.

Ключевая идея: каждый круг отвечает за прибыль в своей зоне, а не за «активность ради активности».

## 2. Идеология холакратии для BikeWerk

## 2.1 Принципы

1. Роль важнее должности: каждый агент имеет четкий домен и измеримый результат.
2. Прозрачная ответственность: любой сигнал имеет владельца, дедлайн и исход.
3. Локальная автономия: круг решает задачи своей зоны без согласований с «центром» по мелочам.
4. Эскалация по риску: чем выше денежный/юридический риск, тем выше уровень подтверждения.
5. Анти-хаос: любое решение логируется и проверяется постфактум на финансовый эффект.

## 2.2 Конфликтный приоритет

Если круги конфликтуют:

1. Безопасность и комплаенс (AI-GRC + AI-Head of Quality).
2. Деньги клиента и маржа (AI-CFO).
3. Операционная скорость и SLA (AI-РОП/AI-РОМ).
4. Рост и эксперименты (AI-CRO/AI-Traffic).

Арбитр: AI-CEO.

## 3. Круги и агенты

1. Strategy Circle: `AI-CEO`.
2. Sales Operations Circle: `AI-РОП`, `AI-РОМ`.
3. Revenue Circle: `AI-CRO`, `AI-Traffic Lead`.
4. Unit Economics Circle: `AI-CFO`.
5. Trust & Quality Circle: `AI-Head of Quality`.
6. Reliability Circle: `AI-CTO/SRE`.
7. Governance Circle: `AI-GRC`.

## 4. Связь модулей между собой

## 4.1 Операционный контур заказа

1. Заказ создается и получает статус `pending_manager`.
2. Диспетчер выбирает наиболее разгруженного менеджера и назначает его.
3. Менеджер получает задачу в Telegram, принимает заказ и ведет сделку.
4. Менеджер выполняет 28-пунктовую проверку (чеклист + артефакты).
5. AI-РОП контролирует переходы статусов, SLA и возврат результата проверки.
6. При согласии клиента AI-РОП ведет этапы до `ready_for_shipment` -> `in_transit` -> `delivered`.
7. AI-CFO контролирует маржу и утечки.
8. AI-Head of Quality контролирует риски дефекта/компенсаций.
9. AI-CEO получает сводный сигнал и приоритизирует эскалации.

## 4.2 Технический контур

- Источник метрик: `/api/admin/workspace`.
- Источник статусов: CRM endpoints + `order_status_events`.
- Канал действий: admin UI + Telegram admin/manager workflows.
- Контур решений: таблицы `ai_signals`, `ai_decisions`, `ai_assignments`, `ai_sla_violations`.

## 5. Люди и ИИ: разделение труда

## 5.1 Что делают люди

- Коммуникация с продавцом/клиентом на сложных кейсах.
- Финальное подтверждение рискованных статусов и выплат.
- Переговоры там, где нужна гибкость и личный контакт.
- Разбор нестандартных форс-мажоров.

## 5.2 Что делают ИИ-руководители

- Назначение владельца и приоритета задачи.
- Контроль SLA и таймеров по каждому заказу.
- Проверка полноты данных перед сменой статуса.
- Авто-эскалации и кризис-плейбуки.
- Ежедневные/еженедельные управленческие своды.

## 6. KPI по отделам (кругам)

## 6.1 Sales Operations (AI-РОП, AI-РОМ)

- `pending_manager_orders`
- median `time_to_next_status`
- SLA breach rate
- доля заказов, застрявших > 72h
- throughput на менеджера

## 6.2 Revenue (AI-CRO, AI-Traffic)

- lead -> order conversion
- checkout -> booking conversion
- funnel drop-off в критических этапах
- channel quality score
- attributable gross margin by channel

## 6.3 Unit Economics (AI-CFO)

- net margin EUR
- margin %
- margin leak count / EUR
- realized vs booked ratio
- forecast accuracy

## 6.4 Trust & Quality (AI-Head of Quality)

- compensation count/amount
- dispute rate
- severe defect share
- repeat incident rate

## 6.5 Reliability (AI-CTO/SRE)

- API p95
- incident count and MTTR
- data contract violations
- funnel critical path health

## 6.6 Governance (AI-GRC)

- compliance risk count
- sanctions-screen coverage
- doc-to-process drift count
- policy update lead time

## 7. Кризис-менеджмент (единый протокол)

Любой агент может поднять кризис-сигнал, но дальше действует единый протокол:

1. Severity: `critical | high | medium | low`.
2. Owner: круг-владелец.
3. SLA:
   - `critical` <= 15 мин
   - `high` <= 2 часа
   - `medium` <= 24 часа
   - `low` weekly review
4. Decision:
   - автодействие (низкий риск),
   - подтверждение человека (деньги/право/массовые изменения).
5. Postmortem: причина, действие, эффект, защита от повтора.

## 8. Финальная целевая модель (To-Be)

1. AI-РОП управляет операционной очередью и кризисами по заказам в реальном времени.
2. AI-РОМ поднимает качество исполнения менеджеров и дисциплину процесса.
3. AI-CFO защищает маржу и cashflow.
4. AI-CRO + AI-Traffic наращивают качественный поток.
5. AI-Head of Quality и AI-GRC удерживают доверие/законность.
6. AI-CTO/SRE гарантирует работоспособность платформы.
7. AI-CEO ежедневно собирает решения и направляет ресурсы.

## 9. Roadmap достижения модели

## Phase 0 (1 неделя): Инфраструктура сигналов

- Утверждение словаря сигналов, SLA, owners, риск-уровней.
- Создание таблиц: `ai_signals`, `ai_decisions`, `ai_assignments`, `ai_sla_violations`.
- Базовый Decision Log в админке.

## Phase 1 (1-2 недели): MVP AI-РОП (первый рабочий агент)

- Авто-раскидка на менеджера + контроль принятия заявки.
- SLA watchdog по статусам и авто-эскалации в Telegram.
- Контроль возврата 28-пунктовой проверки и полноты артефактов.
- Daily operations digest по очередям и блокерам.

## Phase 2 (1-2 недели): AI-РОМ + AI-CFO

- Scorecards менеджеров и причины SLA-провалов.
- Детектор утечек маржи на заказах и рекомендации корректировок.

## Phase 3 (2 недели): AI-CEO + панель кругов

- Персона `AI CEO` в админке.
- Сводка по всем кругам и арбитраж конфликтующих сигналов.

## Phase 4 (постоянно): Полуавтономия и оптимизация

- Низкорисковые автодействия без подтверждения.
- Еженедельные ретроспективы «сигнал -> действие -> эффект».

## 10. Объективно правильный первый шаг сейчас

При текущем полностью человеческом этапе, самый эффективный старт:

1. Внедрить **MVP AI-РОП как «диспетчер + SLA watchdog + кризисный координатор»**, без полного автопринятия решений по деньгам.
2. Оставить людям исполнение и переговоры, ИИ отдать контроль очередей, сроков, эскалаций и прозрачность.
3. Привязать этот контур к Telegram, чтобы команда видела задачу в моменте, а не «в конце дня».

Почему это лучший старт:

- сразу снимает наибольшую рутину;
- дает эффект на скорости обработки входящего трафика;
- не ломает текущую human-модель;
- создает фундамент для AI-CEO, а не декоративную надстройку.

## 11. Критерии успеха первого релиза (MVP AI-РОП)

- снижение `pending_manager_orders` минимум на 30% за 2 недели;
- снижение доли заказов >72h минимум на 40%;
- SLA breach rate по критичным этапам < 10%;
- 100% заказов имеют назначенного owner и актуальный следующий шаг;
- 100% эскалаций фиксируются с `owner`, `deadline`, `resolution`.
